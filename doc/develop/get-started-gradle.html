<!DOCTYPE html>
<html lang="en">
 <head> 
  <meta charset="utf-8"> 
  <title>Getting started using Gradle</title> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <meta name="description" content="Werval Documentation"> 
  <meta name="keywords" content="werval, documentation"> 
  <!-- Le styles --> 
  <!-- See https://github.com/nerk/asciidoctor-bs-themes --> 
  <link href="css/bootstrap_lumen.css" rel="stylesheet"> 
  <link href="css/base.css" rel="stylesheet"> 
  <link href="css/io.werval.doc.css" rel="stylesheet"> 
  <link href="css/prettify.css" rel="stylesheet"> 
  <!-- HTML5 shim, for IE6-8 support of HTML5 elements --> 
  <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->  
  <!-- Async Analytics --> 
  <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-57721420-1', 'auto');
        ga('send', 'pageview');
    </script> 
 </head> 
 <body onload="prettyPrint()" class="article toc2 toc-right"> 
  <div id="wrap"> 
   <!-- Fixed navbar --> 
   <div class="navbar navbar-default navbar-fixed-top" role="navigation"> 
    <div class="container"> 
     <div class="navbar-header"> 
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> 
      <a class="navbar-brand" href="index.html">Werval 0</a> 
     </div> 
     <div class="navbar-collapse collapse"> 
      <ul class="nav navbar-nav"> 
       <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting started <b class="caret"></b></a> 
        <ul class="dropdown-menu"> 
         <li><a href="get-started-gradle.html">Get started using Gradle</a></li> 
         <li><a href="get-started-maven.html">Get started using Maven</a></li> 
         <li class="divider"></li> 
         <li><a href="getting-started.html">What are Gradle &amp; Maven?</a></li> 
        </ul> </li> 
       <li><a href="guides.html">Guides</a></li> 
       <li><a href="manual.html">Manual</a></li> 
       <li><a href="modules/index.html">Modules</a></li> 
       <li><a href="api/index.html" target="_blank">API Javadoc</a></li> 
      </ul> 
      <ul class="nav navbar-nav navbar-right"> 
       <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown">Development Version<span class="caret"></span></a> 
        <ul class="dropdown-menu" role="menu"> 
         <li><a href="/doc/current/index.html">Current Version (0.5.1)</a></li> 
         <li class="divider"></li> 
         <li><a href="/doc/develop/index.html">Development Version</a></li> 
         <li class="divider"></li> 
         <li><a href="/">Werval Home</a></li> 
        </ul> </li> 
      </ul> 
     </div> 
     <!--/.nav-collapse --> 
    </div> 
   </div> 
   <div class="container"> 
    <ol class="breadcrumb"> 
     <li><a href="index.html">Documentation</a></li> 
     <li class="active">Getting started using Gradle</li> 
    </ol> 
    <div class="page-header"> 
     <h1>Getting started using Gradle</h1> 
    </div> 
    <p></p> 
    <div id="preamble"> 
     <div class="sectionbody"> 
      <div id="toc" class="toc2"> 
       <div id="toctitle" class="title">
         Get started using Gradle 
       </div> 
       <ul class="sectlevel1"> 
        <li><a href="#create_a_new_application">Create a new application</a></li> 
        <li><a href="#run_in_development_mode">Run in development mode</a></li> 
        <li><a href="#application_walkthrough">Application Walkthrough</a></li> 
        <li><a href="#using_the_devshell">Using the DevShell</a></li> 
        <li><a href="#next_steps">Next steps</a></li> 
       </ul> 
      </div> 
      <div class="admonitionblock important"> 
       <table> 
        <tbody> 
         <tr> 
          <td class="icon"> 
           <div class="title">
             Important 
           </div> </td> 
          <td class="content"> 
           <div class="title">
             Install Java 8 
           </div> 
           <div class="paragraph"> 
            <p>You need to install the <a href="http://www.oracle.com/technetwork/java/javase/downloads/">Java 8 JDK</a> and ensure that both of the following commands show the proper same version:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay"><code class="bash language-bash">java -version
$JAVA_HOME/bin/java -version</code></pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>Should output something like:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay"><code class="bash language-bash">java version "1.8.X_XX" <b>(1)</b>
Java(TM) SE Runtime Environment (build 1.8.X_XX-bXXX)
Java HotSpot(TM) 64-Bit Server VM (build XX.XX-bXX, mixed mode)</code></pre> 
            </div> 
           </div> 
           <div class="colist arabic"> 
            <ol> 
             <li> <p>This is Java 8</p> </li> 
            </ol> 
           </div> </td> 
         </tr> 
        </tbody> 
       </table> 
      </div> 
      <div class="paragraph"> 
       <p>For the impatients, here is how to get a Gradle skeleton running in development mode quickly:</p> 
      </div> 
      <div class="admonitionblock tip"> 
       <table> 
        <tbody> 
         <tr> 
          <td class="icon"> 
           <div class="title">
             Tip 
           </div> </td> 
          <td class="content"> 
           <div class="title">
             TL;DR 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay"><code>svn export https://github.com/werval/werval-skel-gradle/trunk werval-gradle &lt;1&gt;
cd werval-gradle
gradle devshell &lt;2&gt;</code></pre> 
            </div> 
           </div> 
           <div class="colist arabic"> 
            <ol> 
             <li> <p>Create a new application</p> </li> 
             <li> <p>Run in development mode</p> </li> 
            </ol> 
           </div> </td> 
         </tr> 
        </tbody> 
       </table> 
      </div> 
     </div> 
    </div> 
    <div class="sect1"> 
     <h2 id="create_a_new_application"><a class="anchor" href="#create_a_new_application"></a>Create a new application</h2> 
     <div class="sectionbody"> 
      <div class="paragraph"> 
       <p>To create a new Werval application based on Gradle, use the following command:</p> 
      </div> 
      <div class="listingblock"> 
       <div class="content"> 
        <pre class="CodeRay"><code class="bash language-bash">svn export https://github.com/werval/werval-skel-gradle/trunk YOUR_APP_NAME</code></pre> 
       </div> 
      </div> 
      <div class="paragraph"> 
       <p>Where <code>YOUR_APP_NAME</code> is, well, your application name. A directory with this name will be created with the new application in it.</p> 
      </div> 
      <div class="admonitionblock important"> 
       <table> 
        <tbody> 
         <tr> 
          <td class="icon"> 
           <div class="title">
             Important 
           </div> </td> 
          <td class="content"> 
           <div class="title">
             Why use Subversion? 
           </div> 
           <div class="paragraph"> 
            <p>Github does not support <code>git archive</code> which is the equivalent of <code>svn export</code>. Github provide a subversion view of git repositories, weâ€™re leveraging that.</p> 
           </div> 
           <div class="paragraph"> 
            <p><code>trunk</code> contains the <code>master</code> branch. You can list available branches and tags using <code>svn ls https://github.com/werval/werval-skel-gradle</code>.</p> 
           </div> 
           <div class="paragraph"> 
            <p>A command line client for easy usage of application skeletons is under active discussion, planned and will be added in a future release.</p> 
           </div> </td> 
         </tr> 
        </tbody> 
       </table> 
      </div> 
     </div> 
    </div> 
    <div class="sect1"> 
     <h2 id="run_in_development_mode"><a class="anchor" href="#run_in_development_mode"></a>Run in development mode</h2> 
     <div class="sectionbody"> 
      <div class="paragraph"> 
       <p>To run a Werval application in development mode, use the <code>devshell</code> Gradle task:</p> 
      </div> 
      <div class="listingblock"> 
       <div class="content"> 
        <pre class="CodeRay"><code>gradle devshell</code></pre> 
       </div> 
      </div> 
      <div class="paragraph"> 
       <p>Your default browser should have opened <a href="http://localhost:23023/">http://localhost:23023/</a> showing the following welcome page:</p> 
      </div> 
      <div class="imageblock"> 
       <div class="content"> 
        <img src="images/welcome.png" alt="Welcome" width="640"> 
       </div> 
      </div> 
      <div class="paragraph"> 
       <p>As stated on the welcome page above, when running the Development Shell, the whole Werval documentation is available right from the HTTP server that run your application. Open <a href="http://localhost:23023/@doc">http://localhost:23023/@doc</a> to browse the documentation. This very article should be available at <a href="http://localhost:23023/@doc/getting-started.html">http://localhost:23023/@doc/getting-started.html</a> but maybe you are already reading it from there.</p> 
      </div> 
      <div class="admonitionblock tip"> 
       <table> 
        <tbody> 
         <tr> 
          <td class="icon"> 
           <div class="title">
             Tip 
           </div> </td> 
          <td class="content"> 
           <div class="paragraph"> 
            <p>In production mode, you need an applicationâ€™s secret. This secret is a key used for cypher and signature operations, it must be unique per application. Its place is in the application configuration, see <code>./src/main/resources/application.conf</code>. One can generate a new random secret using the <code>secret</code> Gradle task:</p> 
           </div> 
           <div class="literalblock"> 
            <div class="content"> 
             <pre>gradle secret</pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>It is easily appended to the <code>application.conf</code> file this way:</p> 
           </div> 
           <div class="literalblock"> 
            <div class="content"> 
             <pre>gradle -q secret &gt;&gt; ./src/main/resources/application.conf</pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>Once you have properly set your applicationâ€™s secret, use the <code>start</code> Gradle task to run your application in production mode:</p> 
           </div> 
           <div class="literalblock"> 
            <div class="content"> 
             <pre>gradle start</pre> 
            </div> 
           </div> </td> 
         </tr> 
        </tbody> 
       </table> 
      </div> 
     </div> 
    </div> 
    <div class="sect1"> 
     <h2 id="application_walkthrough"><a class="anchor" href="#application_walkthrough"></a>Application Walkthrough</h2> 
     <div class="sectionbody"> 
      <div class="paragraph"> 
       <p>The newly created application has a single HTTP route:</p> 
      </div> 
      <div class="listingblock"> 
       <div class="title"> 
        <code>./src/main/resources/routes.conf</code> 
       </div> 
       <div class="content"> 
        <pre class="CodeRay"><code class="routes language-routes">GET / controllers.Application.index</code></pre> 
       </div> 
      </div> 
      <div class="paragraph"> 
       <p>That points to this controller method:</p> 
      </div> 
      <div class="listingblock"> 
       <div class="title"> 
        <code>./src/main/java/controllers/Application.java</code> 
       </div> 
       <div class="content"> 
        <pre class="CodeRay"><code class="java language-java"><span class="directive">public</span> Outcome index()
{
    <span class="keyword">return</span> outcomes().ok( <span class="string"><span class="delimiter">"</span><span class="content">It Works!</span><span class="delimiter">"</span></span> ).build();
}</code></pre> 
       </div> 
      </div> 
      <div class="paragraph"> 
       <p>Here is the project tree:</p> 
      </div> 
      <div class="literalblock"> 
       <div class="content"> 
        <pre>â”œâ”€â”€ src
â”‚   â””â”€â”€ main
â”‚    &nbsp;&nbsp; â”œâ”€â”€ java
â”‚    &nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ controllers
â”‚    &nbsp;&nbsp; â”‚&nbsp;&nbsp;     â””â”€â”€ Application.java            &lt;= Controller Java Class
â”‚    &nbsp;&nbsp; â””â”€â”€ resources
â”‚    &nbsp;&nbsp;     â”œâ”€â”€ application.conf                &lt;= Application Configuration
â”‚    &nbsp;&nbsp;     â””â”€â”€ routes.conf                     &lt;= Routes
â”‚
â””â”€â”€ build.gradle                                &lt;= Gradle build file</pre> 
       </div> 
      </div> 
      <div class="paragraph"> 
       <p>You can see that applications generated by <code>werval</code> follow the well known maven directory tree convention. Yes, it could have simplified things a bit to simply use <code>src</code>, <code>app</code> or <code>conf</code> directory names but this way itâ€™s damn easy to add a Gradle or Maven build to such an application.</p> 
      </div> 
      <div class="paragraph"> 
       <p>At the bottom of the tree you can see the Gradle build file. Here is what youâ€™ll find inside:</p> 
      </div> 
      <div class="listingblock"> 
       <div class="title"> 
        <code>./build.gradle</code> 
       </div> 
       <div class="content"> 
        <pre class="CodeRay"><code class="groovy language-groovy">buildscript {
	repositories { jcenter() }    // &lt;1&gt;
	dependencies { classpath 'io.werval:io.werval.gradle:0' } // &lt;2&gt;
}

apply plugin: 'io.werval.application'       // &lt;3&gt;</code></pre> 
       </div> 
      </div> 
      <div class="colist arabic"> 
       <ol> 
        <li> <p>Add JCenter repository</p> </li> 
        <li> <p>Add Werval Gradle Plugin to build classpath</p> </li> 
        <li> <p>Apply the Werval Gradle plugin</p> </li> 
       </ol> 
      </div> 
      <div class="admonitionblock tip"> 
       <table> 
        <tbody> 
         <tr> 
          <td class="icon"> 
           <div class="title">
             Tip 
           </div> </td> 
          <td class="content"> See the <a href="guides.html#gradle_plugin">Werval Gradle Plugin guide</a> for more insights. </td> 
         </tr> 
        </tbody> 
       </table> 
      </div> 
     </div> 
    </div> 
    <div class="sect1"> 
     <h2 id="using_the_devshell"><a class="anchor" href="#using_the_devshell"></a>Using the DevShell</h2> 
     <div class="sectionbody"> 
      <div class="paragraph"> 
       <p>From now on weâ€™ll take a closer look at Werval Development Shell features. Begin by starting the application in development mode, see above.</p> 
      </div> 
      <div class="paragraph"> 
       <p>At first we will introduce a compilation error in the application sources. Open <code>./src/main/java/controllers/Application.java</code> and make changes that wonâ€™t compile, eg:</p> 
      </div> 
      <div class="listingblock"> 
       <div class="content"> 
        <pre class="CodeRay"><code class="java language-java"><span class="keyword">package</span> <span class="namespace">controllers</span>;

<span class="keyword">import</span> <span class="include">io.werval.controllers</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Application</span> {

    <span class="directive">public</span> Outcome index()
    {
        THIS WON<span class="string"><span class="delimiter">'</span><span class="content">T COMPILE return new io.werval.controllers.Welcome().welcome(); } }</span></span></code></pre> 
       </div> 
      </div> 
      <div class="paragraph"> 
       <p>If you now hit your browser refresh button youâ€™ll see something like that:</p> 
      </div> 
      <div class="imageblock"> 
       <div class="content"> 
        <img src="images/devshell-compile-error.png" alt="Compilation failed" width="640"> 
       </div> 
      </div> 
      <div class="paragraph"> 
       <p>This tells you where the error is.</p> 
      </div> 
      <div class="paragraph"> 
       <p>Now, letâ€™s remove the compilation error but throw an exception:</p> 
      </div> 
      <div class="listingblock"> 
       <div class="content"> 
        <pre class="CodeRay"><code class="java language-java"><span class="keyword">package</span> <span class="namespace">controllers</span>;

<span class="keyword">import</span> <span class="include">io.werval.controllers</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Application</span> {

    <span class="directive">public</span> Outcome index()
        <span class="directive">throws</span> java.io.IOException
    {
        <span class="keyword">if</span>( <span class="predefined-constant">true</span> )
        {
            <span class="exception">Exception</span> crash = <span class="keyword">new</span> <span class="exception">RuntimeException</span>( <span class="string"><span class="delimiter">"</span><span class="content">Wow, it crashed!</span><span class="delimiter">"</span></span> );
            <span class="keyword">throw</span> <span class="keyword">new</span> java.io.IOException( <span class="string"><span class="delimiter">"</span><span class="content">And this would be an explicit error message.</span><span class="delimiter">"</span></span>, crash );
        }
        <span class="keyword">return</span> <span class="keyword">new</span> io.werval.controllers.Welcome().welcome();
    }

}</code></pre> 
       </div> 
      </div> 
      <div class="paragraph"> 
       <p>If you hit your browser refresh button again, this should show up:</p> 
      </div> 
      <div class="imageblock"> 
       <div class="content"> 
        <img src="images/devshell-exception-error.png" alt="Exception" width="640"> 
       </div> 
      </div> 
      <div class="paragraph"> 
       <p>Youâ€™ll notice that when application sources are concerned, the error page has links to open them quickly. Of course this will work better is you setup your development environment to open the files with the right applications.</p> 
      </div> 
      <div class="paragraph"> 
       <p>Ok, things are failing well :-) We will now finally say "Hello World" from our HTTP Application.</p> 
      </div> 
      <div class="paragraph"> 
       <p>Change the controller content to:</p> 
      </div> 
      <div class="listingblock"> 
       <div class="content"> 
        <pre class="CodeRay"><code class="java language-java"><span class="keyword">package</span> <span class="namespace">controllers</span>;

<span class="keyword">import</span> <span class="include">io.werval.api.context</span>.*;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Application</span> {

    <span class="directive">public</span> Outcome index()
    {
        <span class="keyword">return</span> CurrentContext.outcomes().ok( <span class="string"><span class="delimiter">"</span><span class="content">Hello World!</span><span class="delimiter">"</span></span> ).build();
    }

}</code></pre> 
       </div> 
      </div> 
      <div class="paragraph"> 
       <p>Hit your browser refresh button again. This time you should see <strong>Hello World!</strong>.</p> 
      </div> 
      <div class="paragraph"> 
       <p>This is how the Werval Development Shell gives you instant feedback when coding.</p> 
      </div> 
     </div> 
    </div> 
    <div class="sect1"> 
     <h2 id="next_steps"><a class="anchor" href="#next_steps"></a>Next steps</h2> 
     <div class="sectionbody"> 
      <div class="paragraph"> 
       <p>Now that you have a minimal skeleton, the obvious next step is to write your application.</p> 
      </div> 
      <div class="paragraph"> 
       <p>You can use the following resources to learn what you need:</p> 
      </div> 
      <div class="ulist"> 
       <ul> 
        <li> <p><a href="guides.html">Guides</a></p> </li> 
        <li> <p><a href="manual.html">Manual</a></p> </li> 
        <li> <p><a href="modules/index.html">Modules</a></p> </li> 
        <li> <p><a href="api/index.html" target="_blank">API Docs</a></p> </li> 
       </ul> 
      </div> 
     </div> 
    </div> 
    <p></p> 
   </div> 
   <div id="push"></div> 
  </div> 
  <div id="footer"> 
   <p class="muted credit">Â© 2014 | Werval 0 | The Werval Community</p> 
   <p class="muted credit">Mixed with <a href="http://getbootstrap.com/">Bootstrap</a> | Baked with <a href="http://jbake.org">JBake</a></p> 
  </div> 
  <!-- Le javascript
    ================================================== --> 
  <!-- Placed at the end of the document so the pages load faster --> 
  <script src="js/jquery-1.11.1.min.js"></script> 
  <script src="js/bootstrap.min.js"></script> 
  <script src="js/prettify.js"></script> 
  <script src="js/io.werval.doc.js"></script>  
 </body>
</html>